---
import Layout from "../layouts/Layout.astro";
import faqs from "../data/faqs.json";
---

<style>
  .faq-item {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid transparent;
  }

  .faq-item:hover {
    border-color: rgba(255, 107, 0, 0.3);
    transform: translateY(-2px);
  }

  .faq-item.active {
    border-color: #ff6b00;
    box-shadow:
      0 10px 25px -5px rgba(255, 107, 0, 10%),
      0 8px 10px -6px rgba(255, 107, 0, 10%);
  }

  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .faq-item.active .faq-icon {
    transform: rotate(180deg);
  }

  .faq-icon {
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
</style>

<Layout>
  <!-- Page Hero -->
  <section class="gradient-bg text-white py-16">
    <div class="container mx-auto px-4 text-center">
      <h2 class="text-5xl font-bold mb-4">‚ùì Preguntas Frecuentes</h2>
      <p class="text-xl max-w-2xl mx-auto">
        Encuentra respuestas r√°pidas a las preguntas m√°s comunes
      </p>
    </div>
  </section>

  <!-- Search Bar -->
  <section class="py-8 bg-white shadow-sm">
    <div class="container mx-auto px-4">
      <div class="max-w-2xl mx-auto">
        <div class="relative">
          <input
            type="text"
            id="searchInput"
            placeholder="üîç Busca tu pregunta aqu√≠..."
            class="w-full px-6 py-4 pr-12 border-2 border-gray-200 rounded-xl focus:border-sc-orange focus:outline-none text-lg"
            onkeyup="filterFAQs()"
          />
          <button
            class="absolute right-4 top-1/2 transform -translate-y-1/2 text-gray-400"
          >
            <svg
              class="w-6 h-6"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Quick Links -->
  <section class="py-8 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="flex flex-wrap justify-center gap-4">
        {
          faqs.map((section) => (
            <a
              href={`#${section.id}`}
              class="px-6 py-3 bg-white rounded-full shadow-md hover:shadow-lg transition font-semibold text-gray-700 hover:text-sc-orange"
            >
              {section.icon} {section.category}
            </a>
          ))
        }
      </div>
    </div>
  </section>

  <!-- FAQ Sections -->
  <section class="py-16">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <!-- No Results Message -->
        <div id="noResults" class="hidden text-center py-12">
          <div class="text-6xl mb-4">üîç</div>
          <h4 class="text-2xl font-bold text-gray-800 mb-2">
            No encontramos lo que buscas
          </h4>
          <p class="text-gray-600">
            Intenta con otras palabras clave o cont√°ctanos directamente.
          </p>
        </div>

        {
          faqs.map((section) => (
            <div id={section.id} class="mb-12">
              <div class="flex items-center gap-3 mb-6">
                <span class="text-4xl">{section.icon}</span>
                <h3 class="text-3xl font-bold text-gray-800">
                  {section.category}
                </h3>
              </div>

              <div class="space-y-4">
                {section.items.map((faq) => (
                  <div
                    class="faq-item bg-white rounded-xl shadow-md overflow-hidden"
                    onclick="toggleFAQ(this)"
                  >
                    <div class="flex items-center justify-between p-6 cursor-pointer hover:bg-gray-50 transition">
                      <h4 class="font-bold text-gray-800 pr-8">
                        {faq.question}
                      </h4>
                      <svg
                        class="faq-icon w-6 h-6 text-sc-orange shrink-0"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                      >
                        <path
                          stroke-linecap="round"
                          stroke-linejoin="round"
                          stroke-width="2"
                          d="M19 9l-7 7-7-7"
                        />
                      </svg>
                    </div>
                    <div class="faq-answer">
                      <div
                        class="px-6 pb-6 text-gray-600"
                        set:html={faq.answer}
                      />
                    </div>
                  </div>
                ))}
              </div>
            </div>
          ))
        }
      </div>
    </div>
  </section>
  <!-- Still Have Questions CTA -->
  <section class="py-16 bg-linear-to-br from-orange-100 to-red-100">
    <div class="container mx-auto px-4 text-center">
      <div class="max-w-2xl mx-auto">
        <div class="text-6xl mb-6">ü§î</div>
        <h3 class="text-3xl font-bold text-gray-800 mb-4">
          ¬øNo encontraste tu respuesta?
        </h3>
        <p class="text-gray-600 mb-8">
          No te preocupes, estamos aqu√≠ para ayudarte. Cont√°ctanos directamente
          y resolveremos todas tus dudas.
        </p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center">
          <a
            href="https://wa.me/573XXXXXXXXX?text=Hola%2C%20tengo%20una%20pregunta%20sobre%20Social%20Club"
            target="_blank"
            class="inline-block gradient-bg text-white px-8 py-4 rounded-full font-bold text-lg hover:shadow-lg transition"
          >
            üì≤ Preguntar por WhatsApp
          </a>
          <a
            href="tel:+573XXXXXXXXX"
            class="inline-block border-2 border-sc-orange text-sc-orange px-8 py-4 rounded-full font-bold text-lg hover:bg-sc-orange hover:text-white transition"
          >
            üìû Llamar Ahora
          </a>
        </div>
      </div>
    </div>
  </section>

  <script is:inline>
    function toggleFAQ(element) {
      // Close other open items in the same section
      const section = element.closest(".space-y-4");
      const allItems = section.querySelectorAll(".faq-item");

      allItems.forEach((item) => {
        if (item !== element && item.classList.contains("active")) {
          item.classList.remove("active");
          const answer = item.querySelector(".faq-answer");
          answer.style.maxHeight = null;
        }
      });

      // Toggle current item
      element.classList.toggle("active");
      const answer = element.querySelector(".faq-answer");

      if (element.classList.contains("active")) {
        answer.style.maxHeight = answer.scrollHeight + "px";
      } else {
        answer.style.maxHeight = null;
      }
    }

    function filterFAQs() {
      const input = document.getElementById("searchInput");
      const filter = input.value.toLowerCase();
      const faqItems = document.querySelectorAll(".faq-item");
      const sections = document.querySelectorAll(".mb-12");
      const noResults = document.getElementById("noResults");
      let hasVisibleItems = false;

      faqItems.forEach((item) => {
        const question = item.querySelector("h4").innerText.toLowerCase();
        const answer = item
          .querySelector(".faq-answer")
          .innerText.toLowerCase();

        if (question.includes(filter) || answer.includes(filter)) {
          item.style.display = "";
          hasVisibleItems = true;
        } else {
          item.style.display = "none";
        }
      });

      // Hide sections if no items are visible
      sections.forEach((section) => {
        const visibleItems = section.querySelectorAll(
          '.faq-item[style="display: \'\';"], .faq-item:not([style*="display: none"])',
        );
        if (visibleItems.length === 0) {
          section.style.display = "none";
        } else {
          section.style.display = "";
        }
      });

      // Show/hide no results message
      if (hasVisibleItems) {
        noResults.classList.add("hidden");
      } else {
        noResults.classList.remove("hidden");
      }
    }
  </script>
</Layout>
